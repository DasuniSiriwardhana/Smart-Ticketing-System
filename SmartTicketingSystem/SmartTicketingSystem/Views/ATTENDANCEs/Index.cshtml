@model IEnumerable<SmartTicketingSystem.Models.EVENT>
@{
    ViewData["Title"] = "Home";
    var featuredEvents = Model?.Take(4) ?? new List<SmartTicketingSystem.Models.EVENT>();
    var categories = new[] { "Concerts", "Workshops", "Sports", "Arts", "Food", "Tech" };
}

<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-75">
            <div class="col-lg-6 hero-content">
                <h1 class="display-3 fw-bold mb-4 animate__animated animate__fadeInUp">
                    Discover Amazing <span class="text-gradient">Events</span>
                </h1>
                <p class="lead mb-4 animate__animated animate__fadeInUp animate__delay-1s">
                    Find and book tickets for concerts, workshops, sports, and cultural events happening near you.
                    Your next unforgettable experience is just a click away.
                </p>

                <!-- Search Bar -->
                <div class="search-box animate__animated animate__fadeInUp animate__delay-2s">
                    <div class="input-group">
                        <span class="input-group-text bg-white border-0">
                            <i class="fas fa-search text-primary"></i>
                        </span>
                        <input type="text" class="form-control border-0" placeholder="Search for events..." id="searchInput">
                        <button class="btn btn-primary" onclick="searchEvents()">
                            <i class="fas fa-arrow-right me-2"></i>Search
                        </button>
                    </div>
                </div>

                <!-- Quick Categories -->
                <div class="quick-categories mt-4 animate__animated animate__fadeInUp animate__delay-3s">
                    <span class="text-white-50 me-3">Popular:</span>
                    @foreach (var cat in categories.Take(4))
                    {
                        <a href="#" class="category-pill">@cat</a>
                    }
                </div>

                <!-- Stats -->
                <div class="row g-4 mt-5">
                    <div class="col-4">
                        <div class="stat-item">
                            <h3 class="fw-bold text-white mb-0">500+</h3>
                            <p class="text-white-50 mb-0">Events</p>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="stat-item">
                            <h3 class="fw-bold text-white mb-0">10k+</h3>
                            <p class="text-white-50 mb-0">Happy Users</p>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="stat-item">
                            <h3 class="fw-bold text-white mb-0">50+</h3>
                            <p class="text-white-50 mb-0">Organizers</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 d-none d-lg-block">
                <div class="hero-image">
                    <img src="~/images/hero-illustration.svg" alt="Events" class="img-fluid floating">
                </div>
            </div>
        </div>
    </div>
    <div class="hero-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
            <path fill="#ffffff" fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,170.7C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
        </svg>
    </div>
</section>

<!-- Featured Events Section -->
<section class="featured-events py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-5">
            <div>
                <h2 class="fw-bold mb-2">Featured Events</h2>
                <p class="text-muted">Discover our most popular and upcoming events</p>
            </div>
            <a asp-controller="EVENTs" asp-action="Index" class="btn btn-outline-primary btn-lg">
                View All Events <i class="fas fa-arrow-right ms-2"></i>
            </a>
        </div>

        <div class="row g-4">
            @if (featuredEvents.Any())
            {
                @foreach (var ev in featuredEvents)
                {
                    <div class="col-lg-3 col-md-6">
                        <div class="event-card">
                            <div class="event-card-image">
                                <!-- FIXED: Removed ImageUrl reference -->
                                <img src="/images/event-placeholder.jpg" alt="@ev.title">
                                <div class="event-card-overlay">
                                    <span class="badge bg-primary">@ev.visibility</span>
                                    @if (ev.IsOnline == 'Y')
                                    {
                                        <span class="badge bg-info">Online</span>
                                    }
                                </div>
                            </div>
                            <div class="event-card-body">
                                <div class="d-flex justify-content-between mb-2">
                                    <!-- FIXED: Removed category reference -->
                                    <span class="event-category">Event</span>
                                    <!-- FIXED: Removed TicketTypes reference -->
                                    <span class="event-price">Check event for prices</span>
                                </div>
                                <h5 class="event-title">@ev.title</h5>
                                <div class="event-details">
                                    <p class="event-date">
                                        <i class="fas fa-calendar-alt text-primary"></i>
                                        @ev.StartDateTime.ToString("MMM dd, yyyy • h:mm tt")
                                    </p>
                                    <p class="event-location">
                                        <i class="fas fa-map-marker-alt text-primary"></i>
                                        @ev.venue
                                    </p>
                                </div>
                                <div class="event-footer">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="event-capacity">
                                            <i class="fas fa-users"></i> @ev.capacity seats
                                        </span>
                                        <a asp-controller="EVENTs" asp-action="Details" asp-route-id="@ev.eventID"
                                           class="btn btn-sm btn-primary">
                                            Book Now
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <!-- Placeholder Cards -->
                @for (int i = 1; i <= 4; i++)
                {
                    <div class="col-lg-3 col-md-6">
                        <div class="event-card placeholder-card">
                            <div class="event-card-image bg-light"></div>
                            <div class="event-card-body">
                                <div class="placeholder-content"></div>
                                <div class="placeholder-content w-75"></div>
                                <div class="placeholder-content w-50"></div>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>
</section>

<!-- Categories Section -->
<section class="categories-section py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-2">Browse by Category</h2>
            <p class="text-muted">Find events that match your interests</p>
        </div>

        <div class="row g-4">
            @foreach (var category in categories)
            {
                <div class="col-lg-2 col-md-4 col-6">
                    <a href="#" class="category-card">
                        <div class="category-icon">
                            @switch (category)
                            {
                                case "Concerts":
                                    <i class="fas fa-music"></i>
                                    break;
                                case "Workshops":
                                    <i class="fas fa-chalkboard-teacher"></i>
                                    break;
                                case "Sports":
                                    <i class="fas fa-futbol"></i>
                                    break;
                                case "Arts":
                                    <i class="fas fa-paint-brush"></i>
                                    break;
                                case "Food":
                                    <i class="fas fa-utensils"></i>
                                    break;
                                case "Tech":
                                    <i class="fas fa-laptop"></i>
                                    break;
                                default:
                                    <i class="fas fa-calendar"></i>
                                    break;
                            }
                        </div>
                        <h6 class="category-name">@category</h6>
                        <span class="category-count">20+ events</span>
                    </a>
                </div>
            }
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="how-it-works py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-2">How It Works</h2>
            <p class="text-muted">Three simple steps to your next amazing experience</p>
        </div>

        <div class="row g-4">
            <div class="col-md-4">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-icon-wrapper">
                        <i class="fas fa-search"></i>
                    </div>
                    <h4>Find Events</h4>
                    <p class="text-muted">Browse through hundreds of events and find what interests you</p>
                    <a asp-controller="EVENTs" asp-action="Index" class="btn btn-link">
                        Browse Events <i class="fas fa-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
            <div class="col-md-4">
                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-icon-wrapper">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <h4>Book Tickets</h4>
                    <p class="text-muted">Select your seats and complete payment securely</p>
                    @if (User.Identity.IsAuthenticated)
                    {
                        <a asp-controller="BOOKINGs" asp-action="MyBookings" class="btn btn-link">
                            My Bookings <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                    }
                    else
                    {
                        <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-link">
                            Login to Book <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                    }
                </div>
            </div>
            <div class="col-md-4">
                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-icon-wrapper">
                        <i class="fas fa-qrcode"></i>
                    </div>
                    <h4>Get QR Tickets</h4>
                    <p class="text-muted">Receive QR codes for easy entry at the venue</p>
                    @if (User.Identity.IsAuthenticated)
                    {
                        <a asp-controller="TICKETs" asp-action="MyTickets" class="btn btn-link">
                            My Tickets <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="testimonials-section py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-2">What Our Users Say</h2>
            <p class="text-muted">Trusted by thousands of event goers</p>
        </div>

        <div class="row g-4">
            <div class="col-md-4">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"Amazing platform! Found the best concerts and the booking process was seamless. The QR code entry made it super easy."</p>
                    <div class="testimonial-author">
                        <div class="author-avatar">JD</div>
                        <div>
                            <h6 class="mb-0">John Doe</h6>
                            <small class="text-muted">Music Lover</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"As an event organizer, this platform has been a game-changer. Easy event creation, ticket management, and great support!"</p>
                    <div class="testimonial-author">
                        <div class="author-avatar">JS</div>
                        <div>
                            <h6 class="mb-0">Jane Smith</h6>
                            <small class="text-muted">Event Organizer</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"The waiting list feature saved me when events sold out! Got notified and secured my tickets. Highly recommended!"</p>
                    <div class="testimonial-author">
                        <div class="author-avatar">MK</div>
                        <div>
                            <h6 class="mb-0">Mike Kumar</h6>
                            <small class="text-muted">Regular User</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section py-5">
    <div class="container">
        <div class="cta-card text-center">
            <h2 class="fw-bold mb-3">Ready to Experience Amazing Events?</h2>
            <p class="mb-4">Join thousands of happy users and start your event journey today</p>
            @if (!User.Identity.IsAuthenticated)
            {
                <div class="d-flex justify-content-center gap-3">
                    <a asp-area="Identity" asp-page="/Account/Register" class="btn btn-light btn-lg px-5">
                        <i class="fas fa-user-plus me-2"></i>Get Started
                    </a>
                    <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-outline-light btn-lg px-5">
                        <i class="fas fa-sign-in-alt me-2"></i>Login
                    </a>
                </div>
            }
            else
            {
                <a asp-controller="EVENTs" asp-action="Index" class="btn btn-light btn-lg px-5">
                    <i class="fas fa-calendar-alt me-2"></i>Browse Events
                </a>
            }
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Search function
        function searchEvents() {
            var query = $('#searchInput').val();
            if (query.trim()) {
                window.location.href = '@Url.Action("Index", "EVENTs")?search=' + encodeURIComponent(query);
            }
        }

        // Enter key in search
        $('#searchInput').keypress(function(e) {
            if (e.which == 13) {
                searchEvents();
            }
        });

        // Category click
        $('.category-pill, .category-card').click(function(e) {
            e.preventDefault();
            var category = $(this).text().trim();
            window.location.href = '@Url.Action("Index", "EVENTs")?category=' + encodeURIComponent(category);
        });

        // Animate stats counting
        function animateStats() {
            $('.stat-item h3').each(function() {
                var $this = $(this);
                var countTo = parseInt($this.text().replace(/[^0-9]/g, ''));
                $({ countNum: 0 }).animate({
                    countNum: countTo
                }, {
                    duration: 2000,
                    easing: 'swing',
                    step: function() {
                        $this.text(Math.floor(this.countNum) + '+');
                    }
                });
            });
        }

        // Trigger animation when element is in view
        $(window).scroll(function() {
            var hT = $('.hero-section').offset().top,
                hH = $('.hero-section').outerHeight(),
                wH = $(window).height(),
                wS = $(this).scrollTop();

            if (wS > (hT + hH - wH) && wS < (hT + hH)) {
                animateStats();
                $(window).off('scroll');
            }
        });

        // FIXED: Removed wishlist functionality that was causing errors

        // Notification function
        function showNotification(message, type) {
            var notification = $('<div class="alert alert-' + type + ' alert-dismissible fade show notification-toast" role="alert">' +
                message +
                '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>' +
                '</div>');

            $('body').append(notification);
            setTimeout(function() {
                notification.fadeOut('slow', function() {
                    $(this).remove();
                });
            }, 3000);
        }
    </script>
}